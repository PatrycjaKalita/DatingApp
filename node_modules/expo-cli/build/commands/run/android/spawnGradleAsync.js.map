{"version":3,"sources":["../../../../src/commands/run/android/spawnGradleAsync.ts"],"names":["capitalize","name","charAt","toUpperCase","slice","getGradleTask","variant","resolveGradleWPath","androidProjectPath","path","join","process","platform","spawnGradleAsync","gradlew","task","args","Log","isProfiling","push","debug","cwd","stdio","error","status","AbortCommandError"],"mappings":";;;;;;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAEA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;;;AAEA,SAASA,UAAT,CAAoBC,IAApB,EAAkC;AAChC,SAAOA,IAAI,CAACC,MAAL,CAAY,CAAZ,EAAeC,WAAf,KAA+BF,IAAI,CAACG,KAAL,CAAW,CAAX,CAAtC;AACD;;AAED,SAASC,aAAT,CAAuBC,OAAvB,EAAgD;AAC9C,SAAQ,UAASN,UAAU,CAACM,OAAD,CAAU,EAArC;AACD;;AAED,SAASC,kBAAT,CAA4BC,kBAA5B,EAAgE;AAC9D,SAAOC,gBAAKC,IAAL,CAAUF,kBAAV,EAA8BG,OAAO,CAACC,QAAR,KAAqB,OAArB,GAA+B,aAA/B,GAA+C,SAA7E,CAAP;AACD;;AAEM,eAAeC,gBAAf,CAAgC;AACrCL,EAAAA,kBADqC;AAErCF,EAAAA;AAFqC,CAAhC,EAMJ;AACD,QAAMQ,OAAO,GAAGP,kBAAkB,CAACC,kBAAD,CAAlC;AACA,QAAMO,IAAI,GAAGV,aAAa,CAACC,OAAD,CAA1B;AACA,QAAMU,IAAI,GAAG,CACXD,IADW,EAEX;AACA,MAHW,EAIX,MAJW,EAKX;AACA,MANW,EAOX,MAPW,EAQX,uBARW,CAAb;;AAUA,MAAIE,eAAIC,WAAR,EAAqB;AACnB;AACAF,IAAAA,IAAI,CAACG,IAAL,CAAU,WAAV;AACD;;AACDF,iBAAIG,KAAJ,CAAW,KAAIN,OAAQ,IAAGE,IAAI,CAACN,IAAL,CAAU,GAAV,CAAe,EAAzC;;AACA,MAAI;AACF,WAAO,MAAM,2BAAWI,OAAX,EAAoBE,IAApB,EAA0B;AACrCK,MAAAA,GAAG,EAAEb,kBADgC;AAErCc,MAAAA,KAAK,EAAE;AAF8B,KAA1B,CAAb;AAID,GALD,CAKE,OAAOC,KAAP,EAAc;AACd;AACA,QAAIA,KAAK,CAACC,MAAN,KAAiB,GAArB,EAA0B;AACxB;AACA,YAAM,KAAIC,iCAAJ,GAAN;AACD;;AACD,UAAMF,KAAN;AACD;AACF","sourcesContent":["import spawnAsync from '@expo/spawn-async';\nimport path from 'path';\n\nimport { AbortCommandError } from '../../../CommandError';\nimport Log from '../../../log';\n\nfunction capitalize(name: string) {\n  return name.charAt(0).toUpperCase() + name.slice(1);\n}\n\nfunction getGradleTask(variant: string): string {\n  return `install${capitalize(variant)}`;\n}\n\nfunction resolveGradleWPath(androidProjectPath: string): string {\n  return path.join(androidProjectPath, process.platform === 'win32' ? 'gradlew.bat' : 'gradlew');\n}\n\nexport async function spawnGradleAsync({\n  androidProjectPath,\n  variant,\n}: {\n  androidProjectPath: string;\n  variant: string;\n}) {\n  const gradlew = resolveGradleWPath(androidProjectPath);\n  const task = getGradleTask(variant);\n  const args = [\n    task,\n    // ignore linting errors\n    '-x',\n    'lint',\n    // ignore tests\n    '-x',\n    'test',\n    '--configure-on-demand',\n  ];\n  if (Log.isProfiling) {\n    // Generate a profile under `/android/app/build/reports/profile`\n    args.push('--profile');\n  }\n  Log.debug(`  ${gradlew} ${args.join(' ')}`);\n  try {\n    return await spawnAsync(gradlew, args, {\n      cwd: androidProjectPath,\n      stdio: 'inherit',\n    });\n  } catch (error) {\n    // User aborted the command with ctrl-c\n    if (error.status === 130) {\n      // Fail silently\n      throw new AbortCommandError();\n    }\n    throw error;\n  }\n}\n"],"file":"spawnGradleAsync.js"}